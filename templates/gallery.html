{% extends "base.html" %}

{% block title %}Gallery - Work of Art Gallery{% endblock %}

{% block content %}
<!-- Gallery Header -->
<section class="bg-gradient-to-r from-gray-900 to-blue-900 text-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-4">Art Gallery</h1>
        <p class="text-xl text-gray-300 max-w-2xl mx-auto">
            Explore our extensive collection of artworks from talented artists around the world.
        </p>
    </div>
</section>

<!-- Filters Section -->
<section class="py-8 bg-white border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <form method="GET" class="flex flex-col md:flex-row gap-4 items-center justify-between">
            <div class="flex flex-col sm:flex-row gap-4 w-full md:w-auto">
                <!-- Artist Filter -->
                <div class="relative">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Artist</label>
                    <select name="artist" class="filter-select w-full md:w-48 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Artists</option>
                        {% for artist in artists %}
                        <option value="{{ artist.name }}" {% if request.args.get('artist') == artist.name %}selected{% endif %}>
                            {{ artist.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <!-- Year Filter -->
                <div class="relative">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Year</label>
                    <input type="number" name="year" placeholder="Enter year" 
                           value="{{ request.args.get('year', '') }}"
                           class="filter-input w-full md:w-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <!-- Medium Filter -->
                <div class="relative">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Medium</label>
                    <select name="medium" class="filter-select w-full md:w-40 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Mediums</option>
                        <option value="oil" {% if request.args.get('medium') == 'oil' %}selected{% endif %}>Oil Painting</option>
                        <option value="acrylic" {% if request.args.get('medium') == 'acrylic' %}selected{% endif %}>Acrylic</option>
                        <option value="watercolor" {% if request.args.get('medium') == 'watercolor' %}selected{% endif %}>Watercolor</option>
                        <option value="sculpture" {% if request.args.get('medium') == 'sculpture' %}selected{% endif %}>Sculpture</option>
                        <option value="digital" {% if request.args.get('medium') == 'digital' %}selected{% endif %}>Digital Art</option>
                        <option value="photography" {% if request.args.get('medium') == 'photography' %}selected{% endif %}>Photography</option>
                    </select>
                </div>
            </div>
            
            <div class="flex gap-2">
                <button type="submit" class="btn-primary bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-md font-semibold transition-colors">
                    <i class="fas fa-search mr-2"></i>Filter
                </button>
                <a href="{{ url_for('gallery') }}" class="btn-secondary border border-gray-300 text-gray-700 hover:bg-gray-50 px-6 py-2 rounded-md font-semibold transition-colors">
                    <i class="fas fa-undo mr-2"></i>Reset
                </a>
            </div>
        </form>
    </div>
</section>

<!-- Gallery Grid -->
<section class="py-12 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Results Info -->
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-2xl font-bold text-gray-800">
                {% if artworks %}
                    {{ artworks|length }} artwork{{ 's' if artworks|length != 1 else '' }} found
                {% else %}
                    No artworks found
                {% endif %}
            </h2>
            
            <!-- View Toggle -->
            <div class="flex items-center gap-2">
                <span class="text-sm text-gray-600">View:</span>
                <button onclick="toggleView('grid')" id="grid-btn" class="view-toggle active p-2 rounded">
                    <i class="fas fa-th"></i>
                </button>
                <button onclick="toggleView('list')" id="list-btn" class="view-toggle p-2 rounded">
                    <i class="fas fa-list"></i>
                </button>
            </div>
        </div>
        
        {% if artworks %}
        <!-- Grid View -->
        <div id="grid-view" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            {% for artwork in artworks %}
            <div class="artwork-card bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2">
                <div class="relative overflow-hidden group">
                    <img src="{{ artwork.image_url or '/static/images/placeholder-artwork.jpg' }}" 
                         alt="{{ artwork.title }}" 
                         class="w-full h-64 object-cover group-hover:scale-110 transition-transform duration-500">
                    <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 flex items-center justify-center">
                        <div class="opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-4 group-hover:translate-y-0">
                            <a href="{{ url_for('artwork_detail', artwork_id=artwork.id) }}" 
                               class="bg-white text-gray-800 px-6 py-2 rounded-full font-semibold hover:bg-gray-100 transition-colors mr-2">
                                View Details
                            </a>
                        </div>
                    </div>
                    {% if artwork.is_featured %}
                    <div class="absolute top-4 left-4 bg-yellow-500 text-white px-3 py-1 rounded-full text-sm font-semibold">
                        Featured
                    </div>
                    {% endif %}
                </div>
                <div class="p-4">
                    <h3 class="text-lg font-bold text-gray-800 mb-2 line-clamp-2">{{ artwork.title }}</h3>
                    <p class="text-gray-600 mb-2">
                        <i class="fas fa-user mr-1"></i>
                        {% if artwork.artist_name %}
                            <a href="{{ url_for('artist_detail', artist_id=artwork.artist_id) }}" 
                               class="hover:text-blue-600 transition-colors">{{ artwork.artist_name }}</a>
                        {% else %}
                            Unknown Artist
                        {% endif %}
                    </p>
                    <div class="flex justify-between items-center text-sm text-gray-500">
                        {% if artwork.year_created %}
                        <span><i class="fas fa-calendar mr-1"></i>{{ artwork.year_created }}</span>
                        {% endif %}
                        {% if artwork.medium %}
                        <span><i class="fas fa-palette mr-1"></i>{{ artwork.medium }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- List View -->
        <div id="list-view" class="hidden space-y-6">
            {% for artwork in artworks %}
            <div class="artwork-list-item bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
                <div class="flex flex-col md:flex-row">
                    <div class="md:w-1/3 relative">
                        <img src="{{ artwork.image_url or '/static/images/placeholder-artwork.jpg' }}" 
                             alt="{{ artwork.title }}" 
                             class="w-full h-64 md:h-full object-cover">
                        {% if artwork.is_featured %}
                        <div class="absolute top-4 left-4 bg-yellow-500 text-white px-3 py-1 rounded-full text-sm font-semibold">
                            Featured
                        </div>
                        {% endif %}
                    </div>
                    <div class="md:w-2/3 p-6 flex flex-col justify-between">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-800 mb-3">{{ artwork.title }}</h3>
                            <p class="text-lg text-gray-600 mb-3">
                                <i class="fas fa-user mr-2"></i>
                                {% if artwork.artist_name %}
                                    <a href="{{ url_for('artist_detail', artist_id=artwork.artist_id) }}" 
                                       class="hover:text-blue-600 transition-colors font-semibold">{{ artwork.artist_name }}</a>
                                {% else %}
                                    Unknown Artist
                                {% endif %}
                            </p>
                            {% if artwork.description %}
                            <p class="text-gray-700 mb-4 line-clamp-3">
                                {{ artwork.description[:200] }}{% if artwork.description|length > 200 %}...{% endif %}
                            </p>
                            {% endif %}
                            <div class="flex flex-wrap gap-4 text-sm text-gray-600 mb-4">
                                {% if artwork.year_created %}
                                <span><i class="fas fa-calendar mr-1"></i>{{ artwork.year_created }}</span>
                                {% endif %}
                                {% if artwork.medium %}
                                <span><i class="fas fa-palette mr-1"></i>{{ artwork.medium }}</span>
                                {% endif %}
                                {% if artwork.dimensions %}
                                <span><i class="fas fa-expand mr-1"></i>{{ artwork.dimensions }}</span>
                                {% endif %}
                            </div>
                        </div>
                        <div>
                            <a href="{{ url_for('artwork_detail', artwork_id=artwork.id) }}" 
                               class="inline-flex items-center btn-primary bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-md font-semibold transition-colors">
                                View Details <i class="fas fa-arrow-right ml-2"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        {% else %}
        <!-- No Results -->
        <div class="text-center py-16">
            <i class="fas fa-images text-8xl text-gray-300 mb-6"></i>
            <h3 class="text-2xl font-bold text-gray-600 mb-4">No Artworks Found</h3>
            <p class="text-lg text-gray-500 mb-8">
                Try adjusting your filters or browse all artworks.
            </p>
            <a href="{{ url_for('gallery') }}" class="btn-primary bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
                <i class="fas fa-undo mr-2"></i>Show All Artworks
            </a>
        </div>
        {% endif %}
    </div>
</section>

<!-- Load More Section (Future Enhancement) -->
{% if artworks and artworks|length >= 20 %}
<section class="py-8 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <button id="load-more-btn" class="btn-secondary border border-gray-300 text-gray-700 hover:bg-gray-50 px-8 py-3 rounded-lg font-semibold transition-colors">
            <i class="fas fa-plus mr-2"></i>Load More Artworks
        </button>
    </div>
</section>
{% endif %}
{% endblock %}

{% block scripts %}
<script>
function toggleView(viewType) {
    const gridView = document.getElementById('grid-view');
    const listView = document.getElementById('list-view');
    const gridBtn = document.getElementById('grid-btn');
    const listBtn = document.getElementById('list-btn');
    
    if (viewType === 'grid') {
        gridView.classList.remove('hidden');
        listView.classList.add('hidden');
        gridBtn.classList.add('active');
        listBtn.classList.remove('active');
        localStorage.setItem('gallery-view', 'grid');
    } else {
        gridView.classList.add('hidden');
        listView.classList.remove('hidden');
        gridBtn.classList.remove('active');
        listBtn.classList.add('active');
        localStorage.setItem('gallery-view', 'list');
    }
}

// Restore saved view preference
document.addEventListener('DOMContentLoaded', function() {
    const savedView = localStorage.getItem('gallery-view') || 'grid';
    toggleView(savedView);
    
    // Auto-submit form on filter change
    const filterSelects = document.querySelectorAll('.filter-select');
    filterSelects.forEach(select => {
        select.addEventListener('change', function() {
            this.form.submit();
        });
    });
});

// Future: Load more functionality
document.getElementById('load-more-btn')?.addEventListener('click', function() {
    // Implement AJAX load more functionality
    console.log('Load more clicked');
});
</script>
{% endblock %}